<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒã˜æ‰‹ã®ã‚«ã‚¿ãƒã‚’ã ãã†ã‚²ãƒ¼ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—ã«ã‚ˆã‚‹ã‚ºãƒ¼ãƒ ã‚’ç„¡åŠ¹åŒ– */
        }
        .hand-display {
            font-size: 8rem; /* çµµæ–‡å­—ã®ã‚µã‚¤ã‚ºã‚’å¤§ãã */
            line-height: 1;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
            -webkit-user-select: none; /* Safariç”¨ */
            -moz-user-select: none; /* Firefoxç”¨ */
            -ms-user-select: none; /* IEç”¨ */
            transition: transform 0.1s ease-out; /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ */
        }
        .hand-display.pop {
            animation: pop 0.2s ease-out;
        }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .game-container {
            width: 100%;
            max-width: 500px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            margin: auto;
            padding: 1rem;
        }
        .hand-area {
            background-color: #f3f4f6; /* è–„ã„ã‚°ãƒ¬ãƒ¼ã®èƒŒæ™¯ */
            border-radius: 0.75rem; /* è§’ã‚’ä¸¸ã */
            padding: 2rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px; /* æ‰‹ã®è¡¨ç¤ºã‚¨ãƒªã‚¢ã®æœ€å°ã®é«˜ã•ã‚’ç¢ºä¿ */
        }
        .action-button { /* ãƒœã‚¿ãƒ³å…±é€šã®ã‚¹ã‚¿ã‚¤ãƒ« */
            color: white;
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s;
            width: 100%; /* ãƒœã‚¿ãƒ³å¹…ã‚’è¦ªè¦ç´ ã«åˆã‚ã›ã‚‹ */
            margin-bottom: 0.75rem; /* ãƒœã‚¿ãƒ³é–“ã®ãƒãƒ¼ã‚¸ãƒ³ */
        }
        .action-button:last-child {
            margin-bottom: 0;
        }
        .start-button {
            background-color: #10b981; /* ç·‘ç³»ã®èƒŒæ™¯ (Tailwind green-500) */
        }
        .start-button:hover {
            background-color: #059669; /* Tailwind green-600 */
        }
        .reset-button {
            background-color: #0ea5e9; /* æ°´è‰²ç³»ã®èƒŒæ™¯ (Tailwind sky-500) ã«å¤‰æ›´ */
        }
        .reset-button:hover {
            background-color: #0284c7; /* Tailwind sky-600 ã«å¤‰æ›´ */
        }
        /* è¿½åŠ : é€Ÿåº¦åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .speed-button {
            background-color: #f97316; /* ã‚ªãƒ¬ãƒ³ã‚¸ (Tailwind orange-500) */
        }
        .speed-button:hover {
            background-color: #ea580c; /* æ¿ƒã„ã‚ªãƒ¬ãƒ³ã‚¸ (Tailwind orange-600) */
        }
        .count-display {
            color: #4b5563; /* ã‚„ã‚„æ¿ƒã„ã‚°ãƒ¬ãƒ¼ã®æ–‡å­—è‰² (Tailwind gray-600) */
        }
        .title {
            color: #374151; /* æ¿ƒã„ã‚°ãƒ¬ãƒ¼ã®æ–‡å­—è‰² (Tailwind gray-700) */
            font-weight: bold;
            font-size: 1.875rem; /* Tailwindã®text-3xlç›¸å½“ */
            margin-bottom: 1.5rem;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-600 to-blue-500 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl game-container">
        <h1 id="gameTitle" class="title text-center">ãŠãªã˜ã‚‚ã®ã‚’ã ãã†</h1>
        <div id="handArea" class="hand-area">
            <span id="handDisplay" class="hand-display">âœŒï¸</span>
        </div>

        <div id="gameControls" class="mt-4">
            <p id="countDisplay" class="count-display text-lg text-center mb-4">è¡¨ç¤ºå›æ•°: 0</p>
            <button id="startButton" class="action-button start-button">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
            <button id="speedToggleButton" class="action-button speed-button">ã¯ã‚„ã„ã¸</button>
            <button id="resetButton" class="action-button reset-button hidden">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
    </div>

    <script>
        // DOMè¦ç´ ã®å–å¾—
        const handDisplay = document.getElementById('handDisplay');
        const countDisplay = document.getElementById('countDisplay');
        const resetButton = document.getElementById('resetButton');
        const startButton = document.getElementById('startButton');
        const gameTitleElement = document.getElementById('gameTitle');
        // â–¼â–¼â–¼ é€Ÿåº¦å¤‰æ›´ãƒœã‚¿ãƒ³ã‚’å–å¾— â–¼â–¼â–¼
        const speedToggleButton = document.getElementById('speedToggleButton');


        // å®šæ•°
        const HANDS = ["âœŠ", "âœŒï¸", "âœ‹"]; // é€šå¸¸ã®æ‰‹
        const SURPRISE_HANDS = ["ğŸ‘Œ", "ğŸ‘", "ğŸ‘", "ğŸ‘ˆ", "ğŸ‘‰", "ğŸ‘†", "ğŸ‘‡", "ğŸ‘‹", "ğŸ¤™", "ğŸ¤˜", "ğŸ¤", "ğŸ––", "ğŸ¤Ÿ"]; // ã‚µãƒ—ãƒ©ã‚¤ã‚ºã®æ‰‹
        const INITIAL_HAND_DISPLAY = "âœŒï¸";
        // â–¼â–¼â–¼ é€Ÿåº¦ã®å®šæ•°ã‚’å®šç¾© â–¼â–¼â–¼
        const NORMAL_INTERVAL = 1000; // ãµã¤ã†: 1ç§’
        const FAST_INTERVAL = 500;   // ã¯ã‚„ã„: 0.5ç§’
        const SURPRISE_PAUSE_DURATION = 3000;
        const SURPRISE_PROBABILITY = 0.2;

        const APP_INITIAL_TITLE_TEXT = "ãŠãªã˜ã‚‚ã®ã‚’ã ãã†";
        const NORMAL_PLAY_TEXT = "ãŠãªã˜ã‚‚ã®ã‚’ã ãã†";
        const SURPRISE_PLAY_TEXT = "ãŠãªã˜ã®ã§ããŸï¼ï¼Ÿ";

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹å¤‰æ•°
        let displayCount = 0;
        let gameStarted = false;
        let autoChangeIntervalId = null;
        let surprisePauseTimeoutId = null;
        let isSurpriseActive = false;
        // â–¼â–¼â–¼ ç¾åœ¨ã®é€Ÿåº¦ã‚’ä¿æŒã™ã‚‹å¤‰æ•°ã‚’è¿½åŠ  â–¼â–¼â–¼
        let currentInterval = NORMAL_INTERVAL;

        // åˆæœŸçŠ¶æ…‹ã‚’è¨­å®šã™ã‚‹é–¢æ•°
        function initializeGame() {
            gameStarted = false;
            isSurpriseActive = false;

            clearInterval(autoChangeIntervalId);
            clearTimeout(surprisePauseTimeoutId);
            autoChangeIntervalId = null;
            surprisePauseTimeoutId = null;

            handDisplay.textContent = INITIAL_HAND_DISPLAY;
            handDisplay.classList.remove('pop');
            displayCount = 0;
            countDisplay.textContent = `è¡¨ç¤ºå›æ•°: ${displayCount}`;
            gameTitleElement.textContent = APP_INITIAL_TITLE_TEXT;

            startButton.classList.remove('hidden');
            resetButton.classList.add('hidden');
            // â–¼â–¼â–¼ é€Ÿåº¦åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚‚è¡¨ç¤ºã—ã€è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆ â–¼â–¼â–¼
            speedToggleButton.classList.remove('hidden');
            currentInterval = NORMAL_INTERVAL;
            speedToggleButton.textContent = 'ã¯ã‚„ã„ã¸';
        }

        // æ‰‹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¡¨ç¤ºã—ã€ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã‚’å‡¦ç†ã™ã‚‹é–¢æ•°
        function changeHand() {
            if (!gameStarted || isSurpriseActive) {
                return;
            }

            displayCount++;
            countDisplay.textContent = `è¡¨ç¤ºå›æ•°: ${displayCount}`;

            handDisplay.classList.remove('pop');
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    handDisplay.classList.add('pop');
                });
            });

            const showSurprise = Math.random() < SURPRISE_PROBABILITY;

            if (showSurprise) {
                const randomSurpriseIndex = Math.floor(Math.random() * SURPRISE_HANDS.length);
                handDisplay.textContent = SURPRISE_HANDS[randomSurpriseIndex];
                gameTitleElement.textContent = SURPRISE_PLAY_TEXT;
                isSurpriseActive = true;

                surprisePauseTimeoutId = setTimeout(() => {
                    isSurpriseActive = false;
                }, SURPRISE_PAUSE_DURATION);
            } else {
                const randomIndex = Math.floor(Math.random() * HANDS.length);
                handDisplay.textContent = HANDS[randomIndex];
                gameTitleElement.textContent = NORMAL_PLAY_TEXT;
            }
        }
        
        // ã‚¿ã‚¤ãƒãƒ¼ã‚’é–‹å§‹ã¾ãŸã¯å†é–‹ã™ã‚‹é–¢æ•°
        function startTimer() {
            if (autoChangeIntervalId) clearInterval(autoChangeIntervalId);
            // â–¼â–¼â–¼ ç¾åœ¨ã®é€Ÿåº¦è¨­å®š(currentInterval)ã§ã‚¿ã‚¤ãƒãƒ¼ã‚’é–‹å§‹ â–¼â–¼â–¼
            autoChangeIntervalId = setInterval(changeHand, currentInterval);
        }

        // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        startButton.addEventListener('click', () => {
            if (gameStarted) return;

            gameStarted = true;
            startButton.classList.add('hidden');
            // â–¼â–¼â–¼ é€Ÿåº¦å¤‰æ›´ãƒœã‚¿ãƒ³ã‚‚éè¡¨ç¤ºã«ã™ã‚‹ â–¼â–¼â–¼
            speedToggleButton.classList.add('hidden');
            resetButton.classList.remove('hidden');

            changeHand();
            // â–¼â–¼â–¼ ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹é–¢æ•°ã‚’å‘¼ã³å‡ºã™ â–¼â–¼â–¼
            startTimer();
        });
        
        // â–¼â–¼â–¼ é€Ÿåº¦åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ  â–¼â–¼â–¼
        speedToggleButton.addEventListener('click', () => {
            if (currentInterval === NORMAL_INTERVAL) {
                currentInterval = FAST_INTERVAL;
                speedToggleButton.textContent = 'ãµã¤ã†ã¸';
            } else {
                currentInterval = NORMAL_INTERVAL;
                speedToggleButton.textContent = 'ã¯ã‚„ã„ã¸';
            }
        });

        // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        resetButton.addEventListener('click', () => {
            initializeGame();
        });

        // popã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤ã™ã‚‹
        handDisplay.addEventListener('animationend', () => {
            handDisplay.classList.remove('pop');
        });

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–
        initializeGame();
    </script>

</body>
</html>
